# Лабораторная работа №4
## Задача обедающих философов
Способ решения: каждый филосов может взять только две вилки одновременно если они обе свободны - исключаются взаимные блокировки.

для работы в необходимо создать узел /ph

Алгоритм работы философа:
1. Пока время жизни не истекло:
2. проверить лежащие рядом с ним вилки:
3. если обе вилки заняты (существуют узлы /ph/$id /ph/${id +1 mod n}) - ждать события от zookeeper и перейти к пункту 1 (id - номер философа, n количество философов)
4. если вилки свободны - взять (создать узлы вилок)
5. ждать случайное время от 0 до 5 секунд
6. освободить вилки (удалить узлы)
7. ждать случайное время от 0 до 5 с
8. перейти к пункту 1

## Двухфазный коммит
Реализованны классы Coordinator, принимающий решение о результате транзакций, и Client, голосующий о результате.

Алгоритм работы координатора:
1. Создать узел /transaction_i cо значением "preparing"
2. Проверить дочерние узлы /transaction_i/client_j
3. Если все клиенты проголосовали (создали дочерние узлы и записали результат) - вынести решение о результате транзакции, иначе ожидать событие от zookeeper и перейти к пункту 2
4. Записать результат в узел /transaction_i
5. завершить работу

Алгоритм работы клиента:
1. Найти последнюю транзакицию /transaction_i
2. Если транзакция уже завершена - записать результат в свой узел и завершить работу
3. Иначе - если узел transaction_i/client_j не существует - создать его, записать случайно commit или abort (проголосовать)
4. Ожидать событие от zookeeper, перейти к пункту 2
